@model IEnumerable<Cosmos.Models.Game>
@{
	ViewData["Title"] = "Browse Games";
}

<div class="container-fluid bg-light text-dark">
	<div class="container page-padding h100">
		<div class="row">
			<div class="col-md-4 col-lg-3">
				<aside>
					@await Component.InvokeAsync("GamesFilterMenu", new
						{
							currentFilters =
											ViewContext.HttpContext.Request.Query
											.Where(q => q.Key.StartsWith("filter"))
											.ToDictionary(q => q.Key, q => string.Join(",", q.Value))
						})
				</aside>
			</div>
			<div class="col-md-8 col-lg-9">
				<div class="row">
					@foreach (var item in Model)
					{
						<div class="col-md-3 col-lg-3">
							<a asp-controller="CustomerGames" asp-action="Details" asp-route-id="@item.Id"
								class="game-card-link">
								<div class="card game-card">
									<img src="~/@item.ImagePath" class="game-card-img-top"
										alt="@Html.DisplayFor(modelItem => item.Name)">
									<div class="card-body d-flex flex-column justify-content-between">
										<div>
											<p class="fw-bold mb-1">@Html.DisplayFor(modelItem => item.Name)</p>
											@if (@item.Price > 0.00M)
											{
												<p class="mb-1">@Html.DisplayFor(modelItem => item.Price)</p>
											}
										</div>
										<div>
											@foreach (var subscription in item.Subscriptions)
											{
												<span
													class="badge rounded-pill bg-dark text-light mb-1">@subscription.Name</span>
											}
										</div>
									</div>
								</div>
							</a>
						</div>
					}
				</div>
			</div>
		</div>
	</div>
</div>